name: CI
on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v5
    
    - name: Validate stencil files
      run: |
        echo "Validating VMware stencil files..."
        
        # Check if required directories exist
        if [ ! -d "stencils" ]; then
          echo "❌ Missing stencils/ directory"
          exit 1
        fi
        
        if [ ! -d "icons" ]; then
          echo "❌ Missing icons/ directory"
          exit 1
        fi
        
        if [ ! -d "omnigraffle" ]; then
          echo "❌ Missing omnigraffle/ directory"
          exit 1
        fi
        
        # Check if ZIP file exists
        if [ ! -f "VMware-Stencils-2024.zip" ]; then
          echo "❌ Missing VMware-Stencils-2024.zip"
          exit 1
        fi
        
        # Count files
        STENCIL_COUNT=$(find stencils/ -name "*.vssx" -o -name "*.vstm" | wc -l)
        ICON_COUNT=$(find icons/ -name "*.svg" | wc -l)
        OMNI_COUNT=$(find omnigraffle/ -name "*.gstencil" -o -name "*.clr" | wc -l)
        
        echo "✅ Found $STENCIL_COUNT Visio stencil files"
        echo "✅ Found $ICON_COUNT SVG icon files"
        echo "✅ Found $OMNI_COUNT OmniGraffle files"
        echo "✅ All stencil files validated successfully"
