name: Stencil Validation

on:

permissions:
  contents: read
  security-events: write
  actions: read

  push:
    branches: [main, master]
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v5
      
      - name: Validate stencil collection
        run: |
          echo "üé® Validating VMware Visio Stencils Collection..."
          
          set -e
          
          # Check ZIP file
          if [ -f "VMware-Stencils-2024.zip" ]; then
            echo "‚úÖ Found VMware-Stencils-2024.zip ($(du -h VMware-Stencils-2024.zip | cut -f1))"
          else
            echo "‚ùå Missing VMware-Stencils-2024.zip"
            echo "Error: Required ZIP file not found"
            exit 1
          fi
          
          # Validate directories
          for dir in stencils icons omnigraffle; do
            if [ -d "$dir" ]; then
              count=$(find "$dir" -type f 2>/dev/null | wc -l)
              echo "‚úÖ $dir/ directory: $count files"
            else
              echo "‚ùå Missing $dir/ directory"
              echo "Error: Required directory $dir not found"
              exit 1
            fi
          done
          
          # Check specific file types
          echo "üìä File breakdown:"
          echo "  Visio files (.vssx/.vstm): $(find stencils/ -name '*.vssx' -o -name '*.vstm' | wc -l)"
          echo "  SVG icons: $(find icons/ -name '*.svg' | wc -l)"
          echo "  OmniGraffle files: $(find omnigraffle/ -name '*.gstencil' -o -name '*.clr' | wc -l)"
          
          echo "üéâ Stencil collection validation completed successfully!"
